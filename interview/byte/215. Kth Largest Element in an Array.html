<body>
  考察堆或者快速排序
  <script>
    var findKthLargest = function (nums, k) {
      return quickSort(nums)[nums.length - k]

      function kSort(arr) {
        const len = arr.length
        if ((len === 1) | (len === 0)) {
          return arr
        }
        const pivot = arr[0]
        const subArr = arr.slice(1)
        const left = subArr.filter(value => value < pivot)
        const right = subArr.filter(value => value >= pivot)

        return [...quickSort(left), pivot, ...quickSort(right)]
      }
    }

    var findKthLargest = function (nums, k) {
      // 选择排序
      // 定义有序区间 (i, len-1]
      const len = nums.length
      let cnt = 0
      for (let i = len - 1; i >= 0; i--) {
        let maxIndex = i
        for (let j = i - 1; j >= 0; j--) {
          if (nums[maxIndex] < nums[j]) {
            maxIndex = j
          }
        }
        swap(nums, i, maxIndex)
        cnt++
        if (k === cnt) return nums[i]
      }

      function swap(arr, i, j) {
        const temp = arr[i]
        arr[i] = arr[j]
        arr[j] = temp
      }
    }

    function qS(arr) {
      const len = arr.length
      if (len === 0 || len === 1) {
        return arr
      }
      const pivot = arr[0]
      const subArray = arr.slice(1)
      const leftSubArray = subArray.filter(v => v < pivot)
      const rightSubArray = subArray.filter(v => v >= pivot)

      return [...qS(leftSubArray), pivot, ...qS(rightSubArray)]
    }

    function qS2(arr) {
      help(arr, 0, arr.length - 1)
      return arr

      // 区间定义 [l, r] 进行区间排序
      function help(arr, l, r) {
        const len = r - l + 1
        if (len === 0 || len === 1) {
          return
        }
        if (l <= r) {
          const pivotIndex = partition(arr, l, r)
          help(arr, l, pivotIndex - 1)
          help(arr, pivotIndex + 1, r)
        }
      }

      // 分区并返回pivotIndex
      // 区间定义 对 [l,r] 进行区间 partition
      function partition(arr, l, r) {
        let pivotIndex = l + 1
        for (let i = pivotIndex; i <= r; i++) {
          if (arr[i] < arr[l]) {
            swap(arr, i, pivotIndex)
            pivotIndex++
          }
        }
        swap(arr, l, --pivotIndex)
        return pivotIndex
      }

      function swap(arr, i, j) {
        const temp = arr[i]
        arr[i] = arr[j]
        arr[j] = temp
      }
    }

    function qS2(arr, k) {
      const targetIndex = arr.length - k
      return help(arr, 0, arr.length - 1, targetIndex)

      // 区间定义 [l, r] 进行区间排序
      function help(arr, l, r, targetIndex) {
        const len = r - l + 1
        if (len === 0 || len === 1) {
          return
        }
        if (l <= r) {
          const pivotIndex = partition(arr, l, r)
          if (pivotIndex === targetIndex) return arr[targetIndex]
          help(arr, l, pivotIndex - 1, targetIndex)
          help(arr, pivotIndex + 1, r, targetIndex)
        }
      }

      // 分区并返回pivotIndex
      // 区间定义 对 [l,r] 进行区间 partition
      function partition(arr, l, r) {
        let pivotIndex = l + 1
        for (let i = pivotIndex; i <= r; i++) {
          if (arr[i] < arr[l]) {
            swap(arr, i, pivotIndex)
            pivotIndex++
          }
        }
        swap(arr, l, --pivotIndex)
        return pivotIndex
      }

      function swap(arr, i, j) {
        const temp = arr[i]
        arr[i] = arr[j]
        arr[j] = temp
      }
    }
    console.log(qS2([3, 2, 412, 1]))
  </script>

  <script>
    function quickSort(arr) {
      const len = arr.length
      if ((len === 1) | (len === 0)) {
        return arr
      }
      const pivot = arr[0]
      const subArr = arr.slice(1)
      const left = subArr.filter(value => value < pivot)
      const right = subArr.filter(value => value >= pivot)

      return [...quickSort(left), pivot, ...quickSort(right)]
    }
  </script>

  <script>
    // 举例子
    ;[5, 2, 7, 9, 6, 1, 4, 5, 0]

    // call1
    pivot = 5
    left = [2, 1, 4, 0]
    right = [7, 9, 6, 5]
    return [...qsort([2, 1, 4, 0]), 5, ...qsort([7, 9, 6, 5])]

    // call2
    pivot = 2
    left = [1, 0]
    right = [4]
    return [...qsort([1, 0]), 2, ...qsort([4])]

    // call3
    pivot = 1
    left = [0]
    right = []
    return [...qsort([0]), 1, ...qsort([])]

    // call4
    return [0]

    // call5
    return []

    // call6
    return [4]

    // call7
    pivot = 7
    // 略...
  </script>
</body>
