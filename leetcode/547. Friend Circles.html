<!--
 * @Author: SedationH
 * @Date: 2020-07-19 23:24:59
 * @LastEditTime: 2020-07-20 14:50:25
 * @FilePath: /learn-algorithm/leetcode/547. Friend Circles.html
-->

<body>
  <script>
/**
  * @param {number[][]} M
  * @return {number}
  */
var findCircleNum = function (M) {
  class UnionFind {
    constructor(length) {
      this.length = length
      // 学到一招
      this.parents = Array.from({ length }, (_, i) => i)
    }

    // 找到a的老祖先
    find(a) {
      while (this.parents[a] !== a) {
        a = this.parents[a]
      }
      return a
    }

    // 让a的老祖先成为b的老祖先
    union(a, b) {
      const fa = this.find(a),
        fb = this.find(b)
      if (fa !== fb) {
        this.parents[fb] = fa
      }
    }

    getSize() {
      const { length } = this
      const set = new Set()
      for (let i = 0; i < length; i++) {
        set.add(this.find(i))
      }
      return set.size
    }
  }
  const len = M.length
  const uf = new UnionFind(len)
  for (let i = 0; i < len; i++) {
    for (let j = 0; j < i; j++) {
      if (M[i][j]) {
        uf.union(i, j)
      }
    }
  }
  return uf.getSize()
}

    /**
     * @param {number[][]} M
     * @return {number}
     */
    var findCircleNum = function (M) {
      const n = M.length
      const parent = Array(n)
        .fill(0)
        .map((_, i) => i)
      for (let i = 0; i < n; i++) {
        for (let j = 0; j < n; j++) {
          if (M[i][j] === 1) {
            union(i, j)
          }
        }
      }
      const deputy = new Set()
      for (let i = 0; i < n; i++) {
        deputy.add(find(i))
      }
      return deputy.size

      function find(x) {
        while (x !== parent[x]) {
          x = parent[x]
        }
        return x
      }

      /**
       * 把b加入a的集合
       */
      function union(a, b) {
        const pa = find(a),
          pb = find(b)
        if (pa !== pb) {
          parent[pb] = pa
        }
      }
    }
  </script>
</body>
